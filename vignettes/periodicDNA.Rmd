---
title: periodicDNA
author: Jacques Serizay
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
    %\VignetteIndexEntry{Introduction to periodicDNA}
    %\VignetteEngine{knitr::rmarkdown}
    %\VignetteEncoding{UTF-8}
---

```{r, eval = TRUE, echo=FALSE, results="hide", warning=FALSE}
knitr::opts_chunk$set(
    collapse = TRUE,
    comment = "#>"
)
suppressPackageStartupMessages({
    library(GenomicRanges)
    library(ggplot2)
    library(magrittr)
    library(periodicDNA)
})
```

### Dinucleotide periodicity over a set of Genomic Ranges

The main goal of periodicDNA is to quantify periodicity of a given k-mer in a
set of sequences. `getPeriodicity()` can be used to achieve this. 
In the following example, `getPeriodicity()` is usually ran using 
a GRanges object, specifying from which genome this GRanges comes from. 

```{r, eval = TRUE}
data(ce11_proms)
periodicity_result <- getPeriodicity(
    ce11_proms[ce11_proms$which.tissues == 'Ubiq.'][1:500] %>% 
        alignToTSS(upstream = 0, downstream = 150),
    genome = 'ce11',
    motif = 'TT', 
    cores = 1
)
```

The output of `getPeriodicity()` is an object containing the PSD scores 
associated with each period. For a given period, a high PSD score 
indicates a high periodicity of the k-mer of interest. 

```{r, eval = TRUE}
head(periodicity_result$PSD)
periodicity_result$PSD %$% PSD[.$period == 10]
```

Graphical output of `getPeriodicity()` can be obtained using the 
`plotPeriodicityResults()` function: 

```{r, eval = TRUE}
plotPeriodicityResults(periodicity_result)
```

The first plot shows the raw distribution of distances between pairs of 'TT' 
in the sequences of the provided GRanges. The second plot shows the 
decay-normalised distribution. Finally, the third plot shows the PSD scores 
of the 'TT' k-mer, measured from the normalised distribution.  

**Note:**  
`getPeriodicity()` can also be ran directly on a set of sequences of interest 
as follows: 

```{r, eval = TRUE}
data(ce11_proms_seqs)
periodicity_result <- getPeriodicity(
    ce11_proms_seqs,
    motif = 'TT', 
    cores = 1
)
```

### Track of periodicity over a set of Genomic Ranges

Another major aim of periodicDNA is to generate continuous linear tracks of 
k-mer periodicity strength over genomic loci of interest. 
`getPeriodicityTrack()` can be used to generate suck genomic tracks. In the 
following example,  

```{r, eval = FALSE}
WW_10bp_track <- getPeriodicityTrack(
    Biostrings::getSeq(
        BSgenome.Celegans.UCSC.ce11::BSgenome.Celegans.UCSC.ce11
    ),
    granges = ce11_proms, 
    motif = 'WW',
    period = 10,
    cores = 1, 
    bw_file = 'WW-10-bp-periodicity_over-proms.bw'
)
```

When plotted over sets of ubiquitous, germline or somatic TSSs, the resulting 
track clearly shows increase of WW 10-bp periodicity above the ubiquitous and
germline TSSs, whereas somatic TSSs do not show such increase.

```{r, eval = FALSE, results="hide", warning=FALSE}
data(ce11_TSSs)
plotAggregateCoverage(
    WW_10bp_track, 
    ce11_TSSs, 
    xlab = 'Distance from TSS',
    ylab = '10-bp periodicity strength (forward proms.)'
)
```

![](https://raw.githubusercontent.com/js2264/periodicDNA/master/man/figures/TT-10bp-periodicity_tissue-spe-TSSs.png)

## Session info

```{r, eval = TRUE}
sessionInfo()
```